/**
 * MATERIAL ENGINE - Entity Presence & Weight
 * --------------------------------------------------------------------------
 * Defines the "Presence" and "Weight" of an object in the system.
 * 
 * This is part of the Engine Layer where raw CSS properties are allowed.
 * All values MUST use CSS custom properties defined in the design token system.
 */

// ============================================================================
// MATERIAL ENGINE - Entity Presence & Weight
// ============================================================================
@mixin _theme-engine-entity($nature) {
  border-radius: var(--radius-bento, clamp(0.75rem, 1.5vw, 1.25rem));
  transition: all var(--motion-fluid, 0.3s ease);
  
  @if $nature == 'primary' {
    // Fundamental object of current view - White background with subtle shadow
    background: oklch(0.99 0.005 90);  // Pure white
    backdrop-filter: blur(10px);  // Minimal blur
    border: 1px solid oklch(0.85 0.005 220);  // Light gray border
    box-shadow: 0 2px 8px oklch(0.08 0.01 250 / 0.15);  // Subtle shadow
    padding: var(--padding-entity-primary, clamp(1.5rem, 3vw, 2rem));
  }
  @else if $nature == 'secondary' {
    // Supportive, contextual data - Light gray background
    background: oklch(0.96 0.005 220);  // Very light gray
    backdrop-filter: blur(5px);
    border: 1px solid oklch(0.88 0.005 220);  // Lighter border
    padding: var(--padding-entity-secondary, clamp(1rem, 2vw, 1.5rem));
  }
  @else if $nature == 'imperative' {
    // System-critical, high-urgency signal - White with neon blue accent (purposeful)
    background: oklch(0.99 0.005 90);  // White background
    border: 2px solid oklch(0.65 0.25 230);  // Neon blue border (purposeful)
    box-shadow: 0 0 16px oklch(0.65 0.25 230 / 0.3);  // Neon blue glow
    animation: pulse-border 2s infinite;
    padding: var(--padding-entity-primary, clamp(1.5rem, 3vw, 2rem));
  }
  @else if $nature == 'latent' {
    // Backgrounded info awaiting activation - Muted gray
    background: oklch(0.94 0.005 220);  // Light gray
    opacity: 0.7;
    filter: grayscale(0.3);
    border: 1px solid oklch(0.90 0.005 220);
    padding: var(--padding-entity-secondary, clamp(1rem, 2vw, 1.5rem));
  }
  @else if $nature == 'aggregate' {
    // Container summarizing multiple entities - Very light gray
    background: oklch(0.97 0.005 220);  // Very light gray
    backdrop-filter: blur(8px);
    border: 1px solid oklch(0.87 0.005 220);
    padding: var(--padding-entity-aggregate, clamp(2rem, 4vw, 3rem));
  }
  @else if $nature == 'ancestral' {
    // Archived or historical data (legacy state) - Muted gray
    background: oklch(0.95 0.005 220);  // Light gray
    border: 1px solid oklch(0.88 0.005 220);
    opacity: 0.8;
    padding: var(--padding-entity-secondary, clamp(1rem, 2vw, 1.5rem));
  }
  @else if $nature == 'image-adaptive' {
    // Responsive image that maintains aspect ratio and loads appropriate resolution
    position: relative;
    width: 100%;
    height: auto;
    overflow: hidden;
    border-radius: var(--radius-bento, clamp(0.75rem, 1.5vw, 1.25rem));
    
    // Aspect ratio preservation (configurable via CSS custom property)
    // Default: 16:9 (56.25%), also supports: 4:3 (75%), 1:1 (100%), 21:9 (42.86%)
    &::before {
      content: '';
      display: block;
      padding-top: var(--aspect-ratio, 56.25%); // Default 16:9
    }
    
    // Position image absolutely within aspect ratio container
    img {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      display: block;
      object-fit: cover;
      object-position: center;
    }
    
    // Common aspect ratio modifiers (for convenience)
    &.ratio-square {
      --aspect-ratio: 100%; // 1:1
    }
    
    &.ratio-4-3 {
      --aspect-ratio: 75%; // 4:3
    }
    
    &.ratio-21-9 {
      --aspect-ratio: 42.86%; // 21:9 ultrawide
    }
    
    &.ratio-portrait {
      --aspect-ratio: 133.33%; // 3:4 portrait
    }
  }
  @else if $nature == 'embed-responsive' {
    // Embedded content (iframe, video) that maintains aspect ratio
    position: relative;
    width: 100%;
    overflow: hidden;
    border-radius: var(--radius-bento, clamp(0.75rem, 1.5vw, 1.25rem));
    
    // Aspect ratio preservation (configurable via CSS custom property)
    // Default: 16:9 (56.25%), also supports: 4:3 (75%), 1:1 (100%), 21:9 (42.86%)
    padding-top: var(--aspect-ratio, 56.25%); // Default 16:9
    
    iframe,
    embed,
    object,
    video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      border: 0;
    }
    
    // Common aspect ratio modifiers
    &.ratio-square {
      --aspect-ratio: 100%; // 1:1
    }
    
    &.ratio-4-3 {
      --aspect-ratio: 75%; // 4:3 (traditional video)
    }
    
    &.ratio-21-9 {
      --aspect-ratio: 42.86%; // 21:9 ultrawide
    }
    
    &.ratio-9-16 {
      --aspect-ratio: 177.78%; // 9:16 vertical video (TikTok, Stories)
    }
  }
  @else if $nature == 'avatar' {
    // User avatar/profile picture display with status indicator
    display: inline-block;
    position: relative;
    border-radius: 50%;
    overflow: hidden;
    background: var(--avatar-bg, oklch(0.25 0.04 250));
    flex-shrink: 0;
    
    // Size variants via CSS custom properties
    width: var(--avatar-size, 2.5rem);
    height: var(--avatar-size, 2.5rem);
    
    // Avatar image
    img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
    }
    
    // Status indicator dot
    &::after {
      content: '';
      position: absolute;
      bottom: 0;
      right: 0;
      width: 25%;
      height: 25%;
      border-radius: 50%;
      border: 2px solid var(--bg-primary, oklch(0.15 0.03 250));
      display: none; // Hidden by default
    }
    
    // Status states
    &.status-online::after {
      display: block;
      background: var(--status-online, oklch(0.65 0.25 150)); // Green
    }
    
    &.status-away::after {
      display: block;
      background: var(--status-away, oklch(0.75 0.25 85)); // Yellow
    }
    
    &.status-busy::after {
      display: block;
      background: var(--status-busy, oklch(0.55 0.25 25)); // Red
    }
    
    &.status-offline::after {
      display: block;
      background: var(--status-offline, oklch(0.50 0.02 220)); // Gray
    }
    
    // Size modifiers
    &.avatar-xs {
      --avatar-size: 1.5rem;
    }
    
    &.avatar-sm {
      --avatar-size: 2rem;
    }
    
    &.avatar-md {
      --avatar-size: 2.5rem;
    }
    
    &.avatar-lg {
      --avatar-size: 3.5rem;
    }
    
    &.avatar-xl {
      --avatar-size: 5rem;
    }
  }
  @else if $nature == 'badge' {
    // Achievement badges and status indicators
    display: inline-flex;
    align-items: center;
    gap: 0.375em;
    padding: var(--badge-padding, 0.25em 0.75em);
    background: var(--badge-bg, oklch(0.88 0.18 95 / 0.2));
    color: var(--badge-text, oklch(0.88 0.18 95));
    border: 1px solid var(--badge-border, oklch(0.88 0.18 95 / 0.5));
    border-radius: 999px;
    font-size: 0.75rem;
    font-weight: 700;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    white-space: nowrap;
    
    // Badge icon
    .badge-icon {
      width: 1em;
      height: 1em;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    
    // Variant types
    &.badge-success {
      --badge-bg: oklch(0.65 0.25 150 / 0.2);
      --badge-text: oklch(0.75 0.25 150);
      --badge-border: oklch(0.65 0.25 150 / 0.5);
    }
    
    &.badge-warning {
      --badge-bg: oklch(0.75 0.25 85 / 0.2);
      --badge-text: oklch(0.85 0.25 85);
      --badge-border: oklch(0.75 0.25 85 / 0.5);
    }
    
    &.badge-danger {
      --badge-bg: oklch(0.55 0.25 25 / 0.2);
      --badge-text: oklch(0.65 0.25 25);
      --badge-border: oklch(0.55 0.25 25 / 0.5);
    }
    
    &.badge-info {
      --badge-bg: oklch(0.65 0.25 230 / 0.2);
      --badge-text: oklch(0.75 0.25 230);
      --badge-border: oklch(0.65 0.25 230 / 0.5);
    }
    
    &.badge-neutral {
      --badge-bg: oklch(0.50 0.02 220 / 0.2);
      --badge-text: oklch(0.70 0.02 220);
      --badge-border: oklch(0.50 0.02 220 / 0.5);
    }
  }
  @else if $nature == 'notification' {
    // Notification cards and alert displays
    display: flex;
    gap: 1rem;
    padding: var(--notification-padding, clamp(0.875rem, 1.75vw, 1.25rem));
    background: var(--glass-light, oklch(0.18 0.03 248 / 0.6));
    border: 1px solid var(--border-subtle, oklch(0.30 0.04 250 / 0.3));
    border-left: 3px solid var(--notification-accent, oklch(0.88 0.18 95));
    border-radius: var(--radius-bento, clamp(0.75rem, 1.5vw, 1.25rem));
    transition: all var(--motion-snap, 0.2s ease);
    
    // Unread state
    &.unread,
    &[aria-label*="unread"] {
      background: var(--notification-unread, oklch(0.88 0.18 95 / 0.1));
      border-left-width: 4px;
    }
    
    // Notification types
    &.notification-mention {
      --notification-accent: oklch(0.88 0.18 95);
    }
    
    &.notification-comment {
      --notification-accent: oklch(0.65 0.25 230);
    }
    
    &.notification-reaction {
      --notification-accent: oklch(0.75 0.25 150);
    }
    
    &.notification-system {
      --notification-accent: oklch(0.70 0.02 220);
    }
    
    &.notification-urgent {
      --notification-accent: oklch(0.55 0.25 25);
    }
    
    // Hover state for interactive notifications
    &:hover {
      background: var(--glass-hover, oklch(0.22 0.04 246));
      border-color: var(--accent-low, oklch(0.85 0.16 85 / 0.4));
      cursor: pointer;
    }
    
    // Mobile optimization
    @media (max-width: 767px) {
      padding: 0.75rem;
      gap: 0.75rem;
    }
  }
  @else if $nature == 'reaction-picker' {
    // Emoji/reaction selector UI component
    display: flex;
    flex-wrap: wrap;
    gap: var(--picker-gap, clamp(0.375rem, 0.75vw, 0.5rem));
    padding: var(--picker-padding, clamp(0.75rem, 1.5vw, 1rem));
    background: var(--glass-elevated, oklch(0.20 0.04 245 / 0.95));
    border: 1px solid var(--border-accent, oklch(0.30 0.04 250 / 0.5));
    border-radius: var(--radius-bento, clamp(0.75rem, 1.5vw, 1.25rem));
    box-shadow: 0 8px 24px oklch(0.10 0.03 250 / 0.3);
    backdrop-filter: blur(20px);
    max-width: 280px;
    
    // Individual reaction options
    .reaction-option {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      min-width: 2.5rem;
      min-height: 2.5rem;
      padding: 0.5rem;
      border-radius: 0.5rem;
      cursor: pointer;
      transition: all var(--motion-snap, 0.2s ease);
      font-size: 1.25rem;
      
      &:hover {
        background: var(--glass-hover, oklch(0.22 0.04 246));
        transform: scale(1.15);
      }
      
      &:active {
        transform: scale(0.95);
      }
    }
    
    // Categories/sections
    .reaction-category {
      width: 100%;
      padding-top: 0.5rem;
      border-top: 1px solid var(--border-subtle, oklch(0.30 0.04 250 / 0.3));
      
      &:first-child {
        padding-top: 0;
        border-top: none;
      }
    }
    
    .reaction-category-label {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--text-secondary, oklch(0.70 0.02 220));
      text-transform: uppercase;
      letter-spacing: 0.05em;
      margin-bottom: 0.5rem;
    }
  }
  @else if $nature == 'user-card' {
    // User profile preview card with hover actions
    display: flex;
    flex-direction: column;
    gap: 1rem;
    padding: var(--card-padding, clamp(1rem, 2vw, 1.5rem));
    background: var(--glass-light, oklch(0.18 0.03 248 / 0.6));
    border: 1px solid var(--border-subtle, oklch(0.30 0.04 250 / 0.3));
    border-radius: var(--radius-bento, clamp(0.75rem, 1.5vw, 1.25rem));
    transition: all var(--motion-fluid, 0.3s ease);
    backdrop-filter: blur(10px);
    
    // Hover state with elevation
    &:hover {
      background: var(--glass-hover, oklch(0.22 0.04 246));
      border-color: var(--accent-low, oklch(0.85 0.16 85 / 0.4));
      box-shadow: 0 8px 24px oklch(0.10 0.03 250 / 0.3);
      transform: translateY(-2px);
    }
    
    // Card sections
    .user-card-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }
    
    .user-card-body {
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }
    
    .user-card-footer {
      display: flex;
      gap: 0.5rem;
      padding-top: 0.75rem;
      border-top: 1px solid var(--border-subtle, oklch(0.30 0.04 250 / 0.3));
    }
    
    // User stats
    .user-stats {
      display: flex;
      gap: 1rem;
      
      .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        
        .stat-value {
          font-weight: 700;
          font-size: 1.125rem;
          color: var(--text-primary, oklch(0.98 0.01 90));
        }
        
        .stat-label {
          font-size: 0.75rem;
          color: var(--text-secondary, oklch(0.70 0.02 220));
          text-transform: uppercase;
          letter-spacing: 0.05em;
        }
      }
    }
    
    // Mobile optimization
    @media (max-width: 767px) {
      padding: 1rem;
      gap: 0.75rem;
    }
  }
  @else if $nature == 'surface-glass' {
    // Dark glassmorphism surface for headers/navigation
    // Purpose: High-contrast surface with white text on dark background
    background: oklch(0.15 0.02 250 / 0.85);  // Deep dark blue with transparency
    backdrop-filter: blur(20px);
    border-radius: 0;  // Headers typically don't have border radius
    padding: 0;  // Headers control their own internal padding
    
    // Subtle border for definition
    border-bottom: 1px solid oklch(0.25 0.02 250);
    
    // Shadow for depth
    box-shadow: 0 2px 8px oklch(0.05 0.01 250 / 0.3);
    
    // High contrast mode - ensure pure black background
    @media (prefers-contrast: high) {
      background: oklch(0.08 0 0);  // Pure black
      border-bottom: 2px solid oklch(0.30 0 0);
      backdrop-filter: none;
      box-shadow: none;
    }
  }
  @else if $nature == 'transcendent' {
    // Sacred, mission-critical prominence — hero sections, genesis-level content
    // ORIGIN: v4.0 Ontological Transcendence
    // INTENT: Visually elevated beyond primary — the most prominent entity
    background: oklch(0.06 0.02 260);  // Deep void background
    color: oklch(0.99 0.005 90);  // White text
    padding: clamp(2.5rem, 5vw, 4rem);
    border: 1px solid oklch(0.20 0.04 250);  // Consciousness border
    box-shadow:
      0 0 40px oklch(0.65 0.25 230 / 0.15),  // Neon blue outer glow
      inset 0 0 60px oklch(0.05 0.01 260 / 0.5);  // Void depth
    position: relative;
    overflow: hidden;
    
    // Subtle gradient overlay for depth
    &::before {
      content: '';
      position: absolute;
      inset: 0;
      background: linear-gradient(
        175deg,
        oklch(0.10 0.03 250 / 0.4) 0%,
        transparent 50%,
        oklch(0.08 0.02 260 / 0.3) 100%
      );
      pointer-events: none;
    }
    
    @media (prefers-contrast: high) {
      background: oklch(0.05 0 0);
      border: 2px solid oklch(0.30 0 0);
      box-shadow: none;
    }
  }
  @else if $nature == 'ephemeral' {
    // Transient, auto-dismissing content — toast notifications, flash messages
    // ORIGIN: v4.0 Ontological Transcendence
    // INTENT: Content that appears temporarily and self-removes
    background: oklch(0.99 0.005 90);  // White
    border: 1px solid oklch(0.85 0.005 220);
    box-shadow: 0 4px 16px oklch(0.08 0.01 250 / 0.2);
    padding: var(--padding-entity-secondary, clamp(1rem, 2vw, 1.5rem));
    position: fixed;
    z-index: 1000;
    animation: ephemeral-enter 0.3s ease-out;
    
    &.dismissing {
      animation: ephemeral-exit 0.3s ease-in forwards;
    }
    
    @keyframes ephemeral-enter {
      from {
        opacity: 0;
        transform: translateY(-1rem);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
    
    @keyframes ephemeral-exit {
      from {
        opacity: 1;
        transform: translateY(0);
      }
      to {
        opacity: 0;
        transform: translateY(-1rem);
      }
    }
    
    @media (prefers-reduced-motion: reduce) {
      animation: none;
      
      &.dismissing {
        animation: none;
        display: none;
      }
    }
  }
}
